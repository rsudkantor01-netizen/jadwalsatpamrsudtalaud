<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jadwal Satpam RSUD Kab. Kepulauan Talaud</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @media print {
            /* Hide WhatsApp buttons during print */
            button.bg-green-600 {
                display: none !important;
            }
            
            /* Simplify guard display for print */
            .flex-col.items-center.p-2.border.rounded-lg {
                padding: 4px !important;
                border: none !important;
                background: transparent !important;
            }
            
            /* Clean up background for print */
            body {
                background: white !important;
                -webkit-print-color-adjust: exact;
            }
            
            .min-h-screen {
                min-height: auto !important;
            }
            
            .bg-gradient-to-br {
                background: white !important;
            }
            
            /* Remove hover effects */
            .hover\:bg-slate-50:hover {
                background-color: transparent !important;
            }
            
            /* Ensure all content is visible */
            .max-h-96 {
                max-height: none !important;
                overflow: visible !important;
            }
        }
    </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-slate-50 to-slate-100">
    <div class="max-w-7xl mx-auto space-y-6 p-4">
        <!-- Header -->
        <div class="text-center space-y-4 py-8">
            <div class="flex justify-center mb-4">
                <div class="w-24 h-24 bg-blue-600 rounded-full flex items-center justify-center">
                    <i class="fas fa-shield-alt text-white text-4xl"></i>
                </div>
            </div>
            <h1 class="text-4xl font-bold text-slate-900">
                Jadwal Satpam RSUD Kab. Kepulauan Talaud
            </h1>
            <p class="text-lg text-slate-600">
                Periode Oktober - Desember 2025
            </p>
        </div>

        <!-- Today's Schedule -->
        <div class="border-2 border-blue-200 bg-blue-50 rounded-lg p-6" id="todaySchedule">
            <div class="flex items-center gap-2 text-blue-900 mb-4">
                <i class="fas fa-clock text-xl"></i>
                <h2 class="text-xl font-bold">Jadwal Hari Ini</h2>
            </div>
            <div class="flex items-center justify-between">
                <div>
                    <p class="font-semibold text-blue-900" id="todayDate">Loading...</p>
                    <p class="text-blue-700" id="todayDay">Loading...</p>
                </div>
                <div class="flex gap-2 flex-wrap" id="todayGuards">
                    <!-- Today's guards will be inserted here -->
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="space-y-6">
            <!-- Controls -->
            <div class="flex gap-2">
                <button onclick="showMonth('2025-10')" class="month-btn px-4 py-2 border rounded-lg hover:bg-slate-100 transition-colors" data-month="2025-10">
                    Oktober 2025
                </button>
                <button onclick="showMonth('2025-11')" class="month-btn px-4 py-2 border rounded-lg hover:bg-slate-100 transition-colors bg-blue-600 text-white" data-month="2025-11">
                    November 2025
                </button>
                <button onclick="showMonth('2025-12')" class="month-btn px-4 py-2 border rounded-lg hover:bg-slate-100 transition-colors" data-month="2025-12">
                    Desember 2025
                </button>
            </div>

            <!-- Schedule Grid -->
            <div class="border rounded-lg p-6 bg-white">
                <h2 class="text-xl font-bold mb-4" id="scheduleTitle">Jadwal November 2025</h2>
                <p class="text-slate-600 mb-4">2 satpam berjaga setiap hari</p>
                <div class="grid gap-4 max-h-96 overflow-y-auto" id="scheduleGrid">
                    <!-- Schedule will be inserted here -->
                </div>
            </div>

            <!-- Guards List -->
            <div class="border rounded-lg p-6 bg-white">
                <div class="flex items-center gap-2 mb-4">
                    <i class="fas fa-users text-xl"></i>
                    <h2 class="text-xl font-bold">Daftar Satpam</h2>
                </div>
                <p class="text-slate-600 mb-4">Total 6 satpam yang bertugas</p>
                <div class="grid gap-4 md:grid-cols-2" id="guardsList">
                    <!-- Guards list will be inserted here -->
                </div>
            </div>
        </div>

        <!-- Footer -->
        <div class="text-center py-8 text-slate-600">
            <p class="text-sm">
                RSUD Kabupaten Kepulauan Talaud - Sistem Informasi Jadwal Satpam
            </p>
            <p class="text-xs mt-2">
                Periode: Oktober - Desember 2025
            </p>
        </div>
    </div>

    <script>
        // Data satpam
        const securityGuards = [
            {
                id: "1",
                name: "Andriski Mangalo",
                whatsapp: "082196445535"
            },
            {
                id: "2", 
                name: "Fransisco Bitjoli",
                whatsapp: "082196846348"
            },
            {
                id: "3",
                name: "Michael Pangemanan", 
                whatsapp: "081344039144"
            },
            {
                id: "4",
                name: "Juniarti Maliatja",
                whatsapp: "082187735384"
            },
            {
                id: "5",
                name: "Noldi Ansiga",
                whatsapp: "085298644392"
            },
            {
                id: "6",
                name: "Jupri Berhamba", 
                whatsapp: "085343512961"
            }
        ];

        // Generate schedule
        function generateSchedule() {
            const schedule = [];
            const startDate = new Date("2025-10-01");
            const endDate = new Date("2025-12-31");
            
            // Specific assignments mentioned by user
            const specificAssignments = {
                "2025-11-11": ["Juniarti Maliatja", "Michael Pangemanan"],
                "2025-11-12": ["Andriski Mangalo", "Fransisco Bitjoli"], 
                "2025-11-13": ["Noldi Ansiga", "Jupri Berhamba"]
            };
            
            let guardIndex = 0;
            
            for (let date = new Date(startDate); date <= endDate; date.setDate(date.getDate() + 1)) {
                const dateStr = date.toISOString().split('T')[0];
                
                if (specificAssignments[dateStr]) {
                    const assignedNames = specificAssignments[dateStr];
                    const assignedGuards = securityGuards.filter(guard => 
                        assignedNames.includes(guard.name)
                    );
                    schedule.push({
                        date: dateStr,
                        guards: assignedGuards
                    });
                } else {
                    // Rotate 2 guards per day
                    const firstGuard = securityGuards[guardIndex % securityGuards.length];
                    const secondGuard = securityGuards[(guardIndex + 1) % securityGuards.length];
                    
                    schedule.push({
                        date: dateStr,
                        guards: [firstGuard, secondGuard]
                    });
                    
                    guardIndex += 2;
                }
            }
            
            return schedule;
        }

        // Format functions
        function formatDate(dateStr) {
            const date = new Date(dateStr);
            return date.toLocaleDateString('id-ID', { 
                day: 'numeric', 
                month: 'long', 
                year: 'numeric' 
            });
        }

        function getDayName(dateStr) {
            const date = new Date(dateStr);
            return date.toLocaleDateString('id-ID', { weekday: 'long' });
        }

        function formatWhatsAppNumber(number) {
            const cleanNumber = number.replace(/\D/g, '');
            return cleanNumber.startsWith('0') ? `62${cleanNumber.substring(1)}` : cleanNumber;
        }

        function openWhatsApp(phoneNumber) {
            const formattedNumber = formatWhatsAppNumber(phoneNumber);
            window.open(`https://wa.me/${formattedNumber}`, '_blank');
        }

        function createGuardElement(guard) {
            return `
                <div class="flex flex-col items-center p-2 border rounded-lg bg-slate-50">
                    <span class="text-sm font-medium mb-1">${guard.name}</span>
                    <button
                        onclick="openWhatsApp('${guard.whatsapp}')"
                        class="bg-green-600 hover:bg-green-700 text-white text-xs h-6 px-2 rounded flex items-center gap-1 transition-colors"
                    >
                        <i class="fas fa-phone text-xs"></i>
                        WA
                    </button>
                </div>
            `;
        }

        function showMonth(monthStr) {
            // Update button states
            document.querySelectorAll('.month-btn').forEach(btn => {
                if (btn.dataset.month === monthStr) {
                    btn.classList.add('bg-blue-600', 'text-white');
                    btn.classList.remove('hover:bg-slate-100');
                } else {
                    btn.classList.remove('bg-blue-600', 'text-white');
                    btn.classList.add('hover:bg-slate-100');
                }
            });

            // Update title
            const [year, month] = monthStr.split('-');
            const monthNames = ['Januari', 'Februari', 'Maret', 'April', 'Mei', 'Juni',
                              'Juli', 'Agustus', 'September', 'Oktober', 'November', 'Desember'];
            document.getElementById('scheduleTitle').textContent = `Jadwal ${monthNames[parseInt(month) - 1]} ${year}`;

            // Filter and display schedule
            const allSchedule = generateSchedule();
            const monthSchedule = allSchedule.filter(schedule => {
                const scheduleDate = new Date(schedule.date);
                return scheduleDate.getFullYear() === parseInt(year) && 
                       scheduleDate.getMonth() === parseInt(month) - 1;
            });

            const scheduleGrid = document.getElementById('scheduleGrid');
            scheduleGrid.innerHTML = monthSchedule.map(daySchedule => `
                <div class="flex items-center justify-between p-4 border rounded-lg hover:bg-slate-50 transition-colors">
                    <div class="flex-1">
                        <p class="font-semibold">${formatDate(daySchedule.date)}</p>
                        <p class="text-sm text-slate-600">${getDayName(daySchedule.date)}</p>
                    </div>
                    <div class="flex gap-2 flex-wrap">
                        ${daySchedule.guards.map(guard => createGuardElement(guard)).join('')}
                    </div>
                </div>
            `).join('');
        }

        function initializeGuardsList() {
            const guardsList = document.getElementById('guardsList');
            guardsList.innerHTML = securityGuards.map(guard => `
                <div class="border border-slate-200 rounded-lg p-6">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="font-semibold text-lg">${guard.name}</h3>
                            <p class="text-slate-600 flex items-center gap-2 mt-1">
                                <i class="fas fa-phone"></i>
                                ${guard.whatsapp}
                            </p>
                        </div>
                        <button
                            onclick="openWhatsApp('${guard.whatsapp}')"
                            class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded flex items-center gap-2 transition-colors"
                        >
                            <i class="fas fa-phone"></i>
                            WhatsApp
                        </button>
                    </div>
                </div>
            `).join('');
        }

        function initializeTodaySchedule() {
            const today = new Date().toISOString().split('T')[0];
            const allSchedule = generateSchedule();
            const todaySchedule = allSchedule.find(schedule => schedule.date === today);

            if (todaySchedule) {
                document.getElementById('todayDate').textContent = formatDate(todaySchedule.date);
                document.getElementById('todayDay').textContent = getDayName(todaySchedule.date);
                document.getElementById('todayGuards').innerHTML = 
                    todaySchedule.guards.map(guard => createGuardElement(guard)).join('');
            } else {
                document.getElementById('todaySchedule').style.display = 'none';
            }
        }

        // Initialize everything when page loads
        document.addEventListener('DOMContentLoaded', function() {
            initializeGuardsList();
            initializeTodaySchedule();
            showMonth('2025-11'); // Default to November
        });
    </script>
</body>
</html>
